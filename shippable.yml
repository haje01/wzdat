build_environment: Ubuntu 14.04

language: python

python:
    - "2.7"

before_install:
    - "sudo apt-get -qq -y install libatlas-base-dev gfortran libpng-dev  libfreetype6-dev libxft-dev"
    - "sudo apt-get -qq -y install libhdf5-serial-dev"

install: 
    # resolve pytable dependencies first
    - "wget -qO- https://raw.github.com/PyTables/PyTables/develop/requirements.txt | xargs pip install"
    - "cat requirements.txt | xargs pip install"
    - "pip install ."
    - "pip install pytest>=2.6.4"
    - "pip install python-coveralls"

before_script:
    mkdir -p shippable/testresults
    mkdir -p shippable/codecoverage
    touch /var/log/wzdat
    chmod 777 /var/log/wzdat

script:
    - pwd
    - WZDAT_CFG=/wzdat/tests/wzdatcfg.yml nosetests --with-xunit --xunit-file=shippable/testresults/nosetests.xml
    - coverage run --source=wzdat --branch setup.py test
    - coverage xml -o shippable/codecoverage/coverage.xml

after_success:
    #- coveralls
